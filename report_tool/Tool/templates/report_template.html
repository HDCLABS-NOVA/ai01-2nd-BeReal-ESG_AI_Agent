<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>{{ company_name }} {{ report_year }} ESG Report</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        
        :root {
            --dl-orange: #F37321;
            --dl-dark: #222222;
            --dl-gray: #666666;
            --dl-light: #f5f5f5;
            --border-color: #dddddd;
        }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            color: var(--dl-dark);
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background: #fff;
        }
        
        .container {
            max-width: 210mm;
            margin: 0 auto;
            padding: 40px;
            background: white;
        }
        
        /* Cover Page */
        .cover {
            height: 297mm;
            display: flex;
            flex-direction: column;
            justify-content: center;
            border-bottom: 10px solid var(--dl-orange);
            page-break-after: always;
        }
        .cover h1 {
            font-size: 48px;
            color: var(--dl-orange);
            margin: 0;
            line-height: 1.2;
        }
        .cover .year {
            font-size: 80px;
            font-weight: 700;
            color: var(--dl-dark);
            margin-bottom: 20px;
        }
        .cover .subtitle {
            font-size: 24px;
            color: var(--dl-gray);
            margin-top: 20px;
        }
    
        /* Layout */
        h2 {
            font-size: 28px;
            color: var(--dl-dark);
            border-bottom: 3px solid var(--dl-orange);
            padding-bottom: 10px;
            margin-top: 50px;
            margin-bottom: 25px;
        }
        h3 {
            font-size: 18px;
            color: var(--dl-orange);
            margin-top: 30px;
            margin-bottom: 15px;
            font-weight: 700;
            text-transform: uppercase;
        }
        p { margin-bottom: 15px; text-align: justify; }
        
        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
            font-size: 14px;
        }
        th {
            background-color: var(--dl-orange);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 500;
        }
        td {
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
            vertical-align: top;
        }
        tr:nth-child(even) { background-color: #fdfdfd; }
        
        /* GRI Badges */
        .gri-tags { margin-bottom: 15px; }
        .gri-badge {
            display: inline-block;
            background: #eee;
            color: #555;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            margin-right: 5px;
            font-weight: 500;
        }
    
        /* Sections */
        .highlight-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }
        .highlight-card {
            background: var(--dl-light);
            padding: 20px;
            border-top: 4px solid var(--dl-orange);
            text-align: center;
        }
        .highlight-card .val {
            font-size: 32px;
            font-weight: 700;
            color: var(--dl-dark);
            margin: 10px 0;
        }
        .highlight-card .label { font-size: 14px; color: var(--dl-gray); }
    
        .two-col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
        }
    
        /* Footer */
        .footer {
            margin-top: 100px;
            border-top: 1px solid #eee;
            padding-top: 20px;
            font-size: 12px;
            color: #999;
            text-align: center;
        }
        
        /* Progress Bar */
        .progress-bar-bg {
            background: #eee; width: 100%; height: 6px; border-radius: 3px;
        }
        .progress-bar-fill {
            background: #F37321; height: 100%; border-radius: 3px;
        }
        
        .risk-high { color: red; }
        .risk-medium { color: orange; }
    
        @media print {
            body { background: white; }
            .container { width: 100%; max-width: none; padding: 0; }
            .page-break { page-break-before: always; }
            h2 { break-after: avoid; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 1. Cover Page -->
        <div class="cover">
            <div class="year">{{ report_year }}</div>
            <h1>SUSTAINABILITY<br>REPORT</h1>
            <div class="subtitle">{{ company_name }} 지속가능경영보고서</div>
        </div>
        
        <!-- 2. CEO Message -->
        <h2>CEO Message</h2>
        <div class="two-col">
            <div>
                <div class="gri-tags"><span class="gri-badge">GRI 2-22</span></div>
                <p style="font-size:18px; font-weight:500; color:#F37321;">
                    "지속가능한 미래를 위한 혁신과 도전"
                </p>
                <p>{{ formatted_ceo_message }}</p>
            </div>
            <div style="background:#f9f9f9; padding:20px; border-radius:8px;">
                <h3>Report Overview</h3>
                <p><strong>기간:</strong> {{ report_year }}.1.1 ~ 12.31<br>
                <strong>범위:</strong> {{ company_name }} 전체 사업장<br>
                <strong>기준:</strong> GRI Standards 2021</p>
            </div>
        </div>
        
        <!-- 3. Highlights -->
        <h2>{{ report_year }} ESG Highlights</h2>
        <div class="highlight-grid">
            <div class="highlight-card">
                <div class="label">온실가스 배출량 (tCO2eq)</div>
                <div class="val">{{ highlights.env }}</div>
                <div class="label">전년 대비 감축 노력</div>
            </div>
            <div class="highlight-card">
                <div class="label">산업재해율 (LTIR)</div>
                <div class="val">{{ highlights.social }}%</div>
                <div class="label">안전보건 경영 강화</div>
            </div>
            <div class="highlight-card">
                <div class="label">윤리경영 교육 이수율</div>
                <div class="val">100%</div>
                <div class="label">전 임직원 대상</div>
            </div>
        </div>
        
        <!-- 4. Materiality -->
        <h2>Materiality Assessment</h2>
        <div class="gri-tags"><span class="gri-badge">GRI 3-1</span><span class="gri-badge">GRI 3-2</span></div>
        <p>이중 중대성(Double Materiality) 평가를 통해 도출된 핵심 이슈입니다.</p>
        <table>
            <thead><tr><th>Rank</th><th>Material Topic</th><th>GRI Mapping</th><th>Impact</th></tr></thead>
            <tbody>
                {% for issue in material_issues %}
                <tr>
                    <td style="text-align:center; font-weight:bold; color:#F37321">{{ loop.index }}</td>
                    <td>{{ issue.name }}</td>
                    <td><small>{{ issue.gri_codes }}</small></td>
                    <td><div class="progress-bar-bg">
                        <div class="progress-bar-fill" style="width:{{ issue.impact }}%;"></div>
                    </div></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        
        <!-- 5. E/S/G Sections -->
        
        <!-- Environment -->
        <div class="page-break"></div>
        <h2>Environmental Performance</h2>
        <div class="two-col">
            <div>
                <h3>Climate Action</h3>
                {% if tags.env_climate %}<div class="gri-tags">{% for t in tags.env_climate %}<span class="gri-badge">{{ t }}</span>{% endfor %}</div>{% endif %}
                <p>{{ climate_action }}</p>
                <p><strong>정책:</strong> {{ env_policy }}</p>
            </div>
            <div>
                <h3>Key Data</h3>
                <table>
                    <thead><tr><th>Year</th><th>GHG Emissions</th></tr></thead>
                    <tbody>
                        {% for row in env_data %}
                        <tr><td>{{ row.year }}</td><td>{{ row.value }}</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Social -->
        <h2>Social Performance</h2>
        <h3>Safety & Health</h3>
         {% if tags.social_safety %}<div class="gri-tags">{% for t in tags.social_safety %}<span class="gri-badge">{{ t }}</span>{% endfor %}</div>{% endif %}
        <p>{{ safety_management }}</p>
        
        <h3>Supply Chain</h3>
        {% if tags.social_supply %}<div class="gri-tags">{% for t in tags.social_supply %}<span class="gri-badge">{{ t }}</span>{% endfor %}</div>{% endif %}
        <p>{{ supply_chain_policy }}</p>
        <table>
            <thead><tr><th>Category</th><th>Risk Level</th><th>Action</th><th>Status</th></tr></thead>
            <tbody>
                {% for r in supply_chain_risk %}
                <tr>
                    <td>{{ r.category }}</td>
                    <td><span class="{% if r.riskLevel == 'High' %}risk-high{% else %}risk-medium{% endif %}">{{ r.riskLevel }}</span></td>
                    <td>{{ r.action }}</td>
                    <td>{{ r.status }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        
        <!-- Governance -->
        <h2>Governance & Ethics</h2>
        <div class="two-col">
            <div>
                <h3>Structure</h3>
                {% if tags.gov_struct %}<div class="gri-tags">{% for t in tags.gov_struct %}<span class="gri-badge">{{ t }}</span>{% endfor %}</div>{% endif %}
                <p>{{ gov_structure }}</p>
            </div>
            <div>
                <h3>Ethics Validation</h3>
                {% if tags.gov_ethics %}<div class="gri-tags">{% for t in tags.gov_ethics %}<span class="gri-badge">{{ t }}</span>{% endfor %}</div>{% endif %}
                <p>{{ ethics }}</p>
            </div>
        </div>
        
        <!-- 6. GRI Content Index -->
        <div class="page-break"></div>
        <h2>GRI 2021 Content Index</h2>
        <p>본 보고서는 GRI Standards 2021에 따라 작성되었습니다.</p>
        <table>
            <thead><tr><th width="15%">GRI Standard</th><th>Disclosure</th><th>Location</th><th width="10%">Page</th></tr></thead>
            <tbody>
                
                <!-- GRI 2 -->
                <tr><td colspan="4" style="background:#f5f5f5; font-weight:bold">GRI 2: General Disclosures</td></tr>
                {% for row in gri_index.gri2 %}
                <tr>
                    <td>{{ row.code }}</td>
                    <td>{{ row.title }}</td>
                    <td>{{ row.loc }}</td>
                    <td style="text-align:center">{{ row.page }}</td>
                </tr>
                {% endfor %}
                
                <!-- GRI 3 -->
                <tr><td colspan="4" style="background:#f5f5f5; font-weight:bold">GRI 3: Material Topics</td></tr>
                <tr><td>GRI 3-1</td><td>중대 주제 결정</td><td>Materiality Assessment</td><td style="text-align:center">-</td></tr>
                <tr><td>GRI 3-2</td><td>중대 주제 목록</td><td>Material Issues Table</td><td style="text-align:center">-</td></tr>
                <tr><td>GRI 3-3</td><td>중대 주제 관리</td><td>E/S/G Sections</td><td style="text-align:center">-</td></tr>
                
                <!-- Topics -->
                {% if gri_index.topics %}
                <tr><td colspan="4" style="background:#f5f5f5; font-weight:bold">Topic Standards</td></tr>
                {% for row in gri_index.topics %}
                <tr>
                    <td>{{ row.code }}</td>
                    <td>{{ row.title }}</td>
                    <td>{{ row.loc }}</td>
                    <td style="text-align:center">{{ row.page }}</td>
                </tr>
                {% endfor %}
                {% endif %}
                
            </tbody>
        </table>

        <!-- Footer -->
        <div class="footer">
            Copyright © {{ report_year }} All Rights Reserved. This report adheres to GRI Standards 2021.
        </div>
    </div>
</body>
</html>
